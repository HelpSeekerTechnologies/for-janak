<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Operation Lineage Audit — Pipeline Process Overview</title>
<style>
  /* ===== CSS CUSTOM PROPERTIES — HelpSeeker 2026 Brand ===== */
  :root {
    --primary-teal: #28bcb8;
    --aqua: #4bc2c3;
    --navy: #103656;
    --light-bg: #f8fffe;
    --text-primary: #1a1a2e;
    --text-secondary: #4a5568;
    --font-primary: 'Inter', 'Segoe UI', system-ui, sans-serif;
    --gradient-primary: linear-gradient(135deg, #28bcb8, #4bc2c3);
    --card-shadow: 0 2px 12px rgba(16, 54, 86, 0.10);
    --border-subtle: #d4eeed;
    --red-flag: #e74c3c;
    --green-positive: #27ae60;
    --amber-warn: #f39c12;
    --hero-gradient: linear-gradient(135deg, #103656 0%, #1a4a6e 40%, #174260 100%);
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: var(--font-primary);
    background: var(--light-bg);
    color: var(--text-primary);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
  }

  .brand-header {
    background: var(--hero-gradient);
    color: #fff;
    padding: 18px 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 12px;
  }
  .brand-header h1 { font-size: 1.15rem; font-weight: 600; letter-spacing: 0.3px; }
  .brand-header h1 span { color: var(--primary-teal); }
  .brand-header .subtitle { font-size: 0.82rem; opacity: 0.75; font-weight: 400; }
  .brand-header .brand-right { text-align: right; font-size: 0.78rem; opacity: 0.65; }

  .container { max-width: 1400px; margin: 0 auto; padding: 0 24px 60px; }

  /* ===== FILTER CONTROLS ===== */
  .controls-bar {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px 24px;
    background: #fff;
    border: 1px solid var(--border-subtle);
    border-radius: 12px;
    margin-top: 24px;
    flex-wrap: wrap;
  }
  .controls-bar label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--navy);
  }
  .controls-bar select, .controls-bar input[type="checkbox"] {
    font-family: var(--font-primary);
  }
  .controls-bar select {
    padding: 6px 12px;
    border: 1px solid var(--border-subtle);
    border-radius: 6px;
    font-size: 0.85rem;
    background: var(--light-bg);
    color: var(--text-primary);
    cursor: pointer;
  }
  .toggle-label {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.85rem;
    color: var(--text-secondary);
    cursor: pointer;
  }

  /* ===== PIPELINE CANVAS ===== */
  .pipeline-wrapper {
    margin-top: 24px;
    overflow-x: auto;
    padding-bottom: 20px;
  }
  .pipeline {
    display: flex;
    gap: 0;
    min-width: 1200px;
    position: relative;
    padding: 20px 0;
  }

  /* ===== PHASE COLUMNS ===== */
  .phase-column {
    flex: 1;
    min-width: 220px;
    position: relative;
    padding: 0 8px;
  }
  .phase-header {
    text-align: center;
    padding: 14px 12px;
    border-radius: 10px 10px 0 0;
    color: #fff;
    font-weight: 700;
    font-size: 0.92rem;
    position: relative;
  }
  .phase-header .phase-num {
    display: inline-block;
    background: rgba(255,255,255,0.25);
    width: 26px; height: 26px;
    border-radius: 50%;
    line-height: 26px;
    font-size: 0.8rem;
    margin-right: 6px;
    font-weight: 800;
  }
  .phase-header.phase-0 { background: #2c3e50; }
  .phase-header.phase-1 { background: #2980b9; }
  .phase-header.phase-2 { background: #8e44ad; }
  .phase-header.phase-3 { background: #e67e22; }
  .phase-header.phase-4 { background: #27ae60; }

  .phase-body {
    background: #fff;
    border: 1px solid var(--border-subtle);
    border-top: none;
    border-radius: 0 0 10px 10px;
    padding: 16px 12px;
    min-height: 320px;
    position: relative;
  }

  /* ===== STATUS INDICATOR ===== */
  .status-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    font-size: 0.72rem;
    font-weight: 600;
    padding: 3px 10px;
    border-radius: 12px;
    position: absolute;
    top: 10px;
    right: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .status-badge.complete {
    background: #e8f8f0;
    color: var(--green-positive);
  }
  .status-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: var(--green-positive);
    animation: pulse 2s infinite;
  }
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* ===== AGENT CARDS ===== */
  .agent-card {
    background: var(--light-bg);
    border: 1px solid var(--border-subtle);
    border-left: 4px solid var(--primary-teal);
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 10px;
    cursor: pointer;
    transition: all 0.25s ease;
    position: relative;
  }
  .agent-card:hover {
    box-shadow: 0 4px 16px rgba(16, 54, 86, 0.15);
    transform: translateY(-2px);
    border-left-color: var(--navy);
  }
  .agent-card.expanded {
    background: #fff;
    border-left-color: var(--navy);
  }
  .agent-card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 8px;
  }
  .agent-id {
    font-size: 0.7rem;
    font-weight: 800;
    color: var(--primary-teal);
    background: rgba(40, 188, 184, 0.12);
    padding: 2px 8px;
    border-radius: 4px;
    white-space: nowrap;
  }
  .agent-name {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--navy);
    margin-top: 6px;
    line-height: 1.3;
  }
  .agent-runtime {
    font-size: 0.72rem;
    color: var(--text-secondary);
    margin-top: 4px;
  }
  .expand-icon {
    font-size: 0.8rem;
    color: var(--text-secondary);
    transition: transform 0.3s;
    flex-shrink: 0;
    margin-top: 2px;
  }
  .agent-card.expanded .expand-icon {
    transform: rotate(180deg);
  }

  /* ===== AGENT DETAIL ===== */
  .agent-detail {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease, padding 0.3s ease;
    padding: 0 0;
  }
  .agent-card.expanded .agent-detail {
    max-height: 600px;
    padding: 12px 0 0;
  }
  .detail-section {
    margin-bottom: 10px;
  }
  .detail-section-label {
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
    margin-bottom: 3px;
  }
  .detail-section-value {
    font-size: 0.8rem;
    color: var(--text-primary);
    line-height: 1.5;
    padding-left: 8px;
    border-left: 2px solid var(--border-subtle);
  }
  .detail-section-value code {
    background: rgba(40, 188, 184, 0.1);
    padding: 1px 5px;
    border-radius: 3px;
    font-size: 0.75rem;
    font-family: 'Cascadia Code', 'Consolas', monospace;
  }

  /* ===== FLOW ARROWS ===== */
  .flow-arrow-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 10;
  }
  .flow-svg {
    width: 100%;
    height: 100%;
  }

  /* ===== ANIMATED ARROW BETWEEN PHASES ===== */
  .phase-connector {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    flex-shrink: 0;
    position: relative;
  }
  .arrow-line {
    width: 100%;
    height: 3px;
    background: var(--gradient-primary);
    position: relative;
    border-radius: 2px;
  }
  .arrow-line::after {
    content: '';
    position: absolute;
    right: -6px;
    top: -5px;
    width: 0; height: 0;
    border-left: 10px solid var(--aqua);
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
  }
  .arrow-dot {
    position: absolute;
    width: 8px; height: 8px;
    background: var(--primary-teal);
    border-radius: 50%;
    top: -2.5px;
    animation: flowDot 2s linear infinite;
    box-shadow: 0 0 6px rgba(40, 188, 184, 0.6);
  }
  @keyframes flowDot {
    0% { left: 0; opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { left: calc(100% - 8px); opacity: 0; }
  }

  /* ===== HERO SUMMARY ===== */
  .hero-banner {
    background: var(--hero-gradient);
    margin: 0 -24px;
    padding: 32px 24px 36px;
  }
  .hero-title {
    text-align: center;
    color: #fff;
    margin-bottom: 24px;
  }
  .hero-title h2 { font-size: 1.5rem; font-weight: 700; margin-bottom: 4px; }
  .hero-title p { font-size: 0.9rem; opacity: 0.7; }
  .hero-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 16px;
    max-width: 1100px;
    margin: 0 auto;
  }
  .hero-card {
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(75, 194, 195, 0.25);
    border-radius: 12px;
    padding: 20px 16px;
    text-align: center;
    backdrop-filter: blur(4px);
    transition: transform 0.2s, border-color 0.2s;
  }
  .hero-card:hover { transform: translateY(-2px); border-color: var(--primary-teal); }
  .hero-card .metric-value {
    font-size: 2rem;
    font-weight: 800;
    color: var(--primary-teal);
    line-height: 1.1;
    margin-bottom: 4px;
  }
  .hero-card .metric-label {
    font-size: 0.78rem;
    color: rgba(255,255,255,0.85);
    line-height: 1.3;
  }
  .hero-card .metric-sublabel {
    font-size: 0.68rem;
    color: rgba(255,255,255,0.5);
    margin-top: 3px;
  }

  /* ===== TOOLTIP ===== */
  .tooltip-custom {
    position: fixed;
    background: var(--navy);
    color: #fff;
    padding: 10px 14px;
    border-radius: 8px;
    font-size: 0.8rem;
    max-width: 300px;
    pointer-events: none;
    z-index: 1000;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    line-height: 1.5;
    opacity: 0;
    transition: opacity 0.2s;
  }
  .tooltip-custom.visible { opacity: 1; }

  /* ===== DATA PROVENANCE FOOTER ===== */
  .provenance-footer {
    margin-top: 40px;
    background: #fff;
    border: 1px solid var(--border-subtle);
    border-radius: 12px;
    padding: 20px 24px;
  }
  .provenance-footer h4 {
    font-size: 0.9rem;
    color: var(--navy);
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 2px solid var(--primary-teal);
  }
  .provenance-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 12px;
  }
  .provenance-item {
    background: var(--light-bg);
    border: 1px solid var(--border-subtle);
    border-radius: 8px;
    padding: 12px;
  }
  .provenance-item .pv-label {
    font-size: 0.72rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
    font-weight: 600;
    margin-bottom: 2px;
  }
  .provenance-item .pv-value {
    font-size: 0.88rem;
    color: var(--navy);
    font-weight: 600;
  }

  .page-footer {
    text-align: center;
    padding: 24px;
    font-size: 0.78rem;
    color: #8a9aaa;
    border-top: 1px solid var(--border-subtle);
    margin-top: 40px;
  }
  .page-footer strong { color: var(--navy); }

  /* ===== ANIMATION ===== */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .pipeline-wrapper { animation: fadeInUp 0.6s ease both; }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 900px) {
    .pipeline { flex-direction: column; min-width: unset; }
    .phase-connector { width: 100%; height: 30px; }
    .arrow-line { width: 3px; height: 100%; }
    .phase-body { min-height: auto; }
  }

  /* ===== PRINT ===== */
  @media print {
    body { background: #fff; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .brand-header, .hero-banner, .phase-header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .pipeline-wrapper { overflow: visible; }
    .pipeline { min-width: unset; }
    .agent-card.expanded .agent-detail { max-height: none; }
    .arrow-dot { display: none; }
    .no-print { display: none !important; }
    @page { margin: 0.5in; }
  }
</style>
</head>
<body>

<header class="brand-header">
  <div>
    <h1>Operation Lineage Audit &mdash; <span>HelpSeeker Technologies</span></h1>
    <div class="subtitle">Pipeline Process Overview &amp; Agent Flow</div>
  </div>
  <div class="brand-right">
    Automated Analysis Pipeline<br>
    5-Phase Architecture
  </div>
</header>

<div class="container">
  <div class="hero-banner">
    <div class="hero-title">
      <h2>Pipeline Process Overview</h2>
      <p>5 phases, 8 agents, from raw Databricks data to validated HTML dashboards</p>
    </div>
    <div class="hero-grid">
      <div class="hero-card">
        <div class="metric-value">5</div>
        <div class="metric-label">Pipeline Phases</div>
        <div class="metric-sublabel">Data &rarr; Graph &rarr; Query &rarr; Synthesis &rarr; Validation</div>
      </div>
      <div class="hero-card">
        <div class="metric-value">8</div>
        <div class="metric-label">Autonomous Agents</div>
        <div class="metric-sublabel">0A, 0B, 0D, 1, 2, 3, 4 + Orchestrator</div>
      </div>
      <div class="hero-card">
        <div class="metric-value">76,935</div>
        <div class="metric-label">Graph Relationships</div>
        <div class="metric-sublabel">Neo4j Aura knowledge graph</div>
      </div>
      <div class="hero-card">
        <div class="metric-value">2.7M+</div>
        <div class="metric-label">Source Records</div>
        <div class="metric-sublabel">GOA 1.8M + GoC 0.9M rows processed</div>
      </div>
      <div class="hero-card">
        <div class="metric-value">100%</div>
        <div class="metric-label">Pipeline Complete</div>
        <div class="metric-sublabel">All phases validated and green</div>
      </div>
    </div>
  </div>

  <!-- Filter Controls -->
  <div class="controls-bar">
    <label for="phaseFilter">Filter Phase:</label>
    <select id="phaseFilter">
      <option value="all">All Phases</option>
      <option value="0">Phase 0: Data Assembly</option>
      <option value="1">Phase 1: Graph Construction</option>
      <option value="2">Phase 2: Governance Queries</option>
      <option value="3">Phase 3: Synthesis &amp; HTML</option>
      <option value="4">Phase 4: Validation</option>
    </select>
    <div class="toggle-label">
      <input type="checkbox" id="expandAll">
      <span>Expand all agent cards</span>
    </div>
    <div class="toggle-label">
      <input type="checkbox" id="toggleAnimation" checked>
      <span>Animate flow arrows</span>
    </div>
  </div>

  <!-- Pipeline Visualization -->
  <div class="pipeline-wrapper">
    <div class="pipeline" id="pipelineContainer">

      <!-- PHASE 0: Data Assembly -->
      <div class="phase-column" data-phase="0">
        <div class="phase-header phase-0">
          <span class="phase-num">0</span> Data Assembly
        </div>
        <div class="phase-body">
          <div class="status-badge complete"><div class="status-dot"></div> Complete</div>

          <div class="agent-card" data-agent="0A"
               data-tooltip="Agent 0A: Aggregates 1.8M GOA grant records into ministry-linked summaries">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 0A</div>
                <div class="agent-name">Grant-Ministry Linker</div>
                <div class="agent-runtime">~55s runtime</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value">Databricks <code>goa_grants_disclosure</code> (1.8M rows)</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">Aggregates grant records by recipient + ministry + fiscal year. Tags political era (PC/NDP/UCP-Kenney/UCP-Smith). Links ministry names through lineage chains.</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value"><code>grants_aggregated.csv</code> (702,930 rows)</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">~55 seconds (Databricks SQL + local aggregation)</div>
              </div>
            </div>
          </div>

          <div class="agent-card" data-agent="0B"
               data-tooltip="Agent 0B: Builds director network from CRA T3010 filings, identifies multi-board directors">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 0B</div>
                <div class="agent-name">Director Network Builder</div>
                <div class="agent-runtime">~9s runtime</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value">Databricks <code>multi_board_directors</code>, <code>org_clusters_strong</code></div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">Extracts directors serving on 3+ boards. Computes shared-director edges between organizations. Identifies governance clusters via connected components.</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value">4 CSVs: <code>directors.csv</code>, <code>sits_on.csv</code>, <code>shared_directors.csv</code>, <code>clusters.csv</code></div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">~9 seconds (Databricks SQL queries)</div>
              </div>
            </div>
          </div>

          <div class="agent-card" data-agent="0D"
               data-tooltip="Agent 0D: Processes 2.2GB of federal GoC Grants &amp; Contributions data">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 0D</div>
                <div class="agent-name">Federal Grants Processor</div>
                <div class="agent-runtime">~108s runtime</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value">Databricks GoC Grants volume (2.2 GB raw data)</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">Parses federal Grants &amp; Contributions disclosure. Filters to Alberta recipients. Standardizes amounts and dates. Links to CRA BN numbers where available.</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value"><code>federal_grants.csv</code> (109,583 rows)</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">~108 seconds (large file parsing + filtering)</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Arrow 0→1 -->
      <div class="phase-connector" data-connector="0-1">
        <div class="arrow-line">
          <div class="arrow-dot"></div>
        </div>
      </div>

      <!-- PHASE 1: Graph Construction -->
      <div class="phase-column" data-phase="1">
        <div class="phase-header phase-1">
          <span class="phase-num">1</span> Graph Construction
        </div>
        <div class="phase-body">
          <div class="status-badge complete"><div class="status-dot"></div> Complete</div>

          <div class="agent-card" data-agent="1"
               data-tooltip="Agent 1: Ingests all Phase 0 CSVs into Neo4j Aura graph database (76,935 relationships)">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 1</div>
                <div class="agent-name">Graph Builder &mdash; Neo4j Aura</div>
                <div class="agent-runtime">~2.5 hrs runtime</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value">All Phase 0 CSVs: <code>grants_aggregated.csv</code>, <code>directors.csv</code>, <code>sits_on.csv</code>, <code>shared_directors.csv</code>, <code>clusters.csv</code>, <code>federal_grants.csv</code></div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">Creates KGL v1.3 aligned schema (12 node types, 10 relationship types). MERGE-based idempotent ingestion. Builds indexes for Cypher query performance. Validates entity counts post-load.</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value">Neo4j graph: 76,935 relationships, 35,075 RECEIVED_GRANT, 11,023 SITS_ON, 9,081 SHARED_DIRECTORS edges</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">~2.5 hours (batch MERGE with rate limiting)</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Arrow 1→2 -->
      <div class="phase-connector" data-connector="1-2">
        <div class="arrow-line">
          <div class="arrow-dot" style="animation-delay: 0.4s;"></div>
        </div>
      </div>

      <!-- PHASE 2: Governance Analysis -->
      <div class="phase-column" data-phase="2">
        <div class="phase-header phase-2">
          <span class="phase-num">2</span> Governance Queries
        </div>
        <div class="phase-body">
          <div class="status-badge complete"><div class="status-dot"></div> Complete</div>

          <div class="agent-card" data-agent="2"
               data-tooltip="Agent 2: Executes 3 multi-hop Cypher queries + symmetry test against the Neo4j graph">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 2</div>
                <div class="agent-name">Graph Analyst &mdash; 3 Cypher Queries + Symmetry</div>
                <div class="agent-runtime">~8s runtime</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value">Neo4j Aura graph via Cypher queries (multi-hop traversals)</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">
                  Q1: Ministry lineage funding trajectory across political eras<br>
                  Q2: Cluster-funding disparity (clustered vs non-clustered)<br>
                  Q3: Top governance clusters with per-era breakdown<br>
                  Q4: Symmetry test &mdash; NDP vs UCP disparity comparison
                </div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value">4 result CSVs: <code>q1_ministry_lineage.csv</code>, <code>q2_disparity.csv</code>, <code>q3_cluster_ndp_audit.csv</code>, <code>q4_symmetry.csv</code></div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">~8 seconds (indexed Cypher queries)</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Arrow 2→3 -->
      <div class="phase-connector" data-connector="2-3">
        <div class="arrow-line">
          <div class="arrow-dot" style="animation-delay: 0.8s;"></div>
        </div>
      </div>

      <!-- PHASE 3: Synthesis & HTML -->
      <div class="phase-column" data-phase="3">
        <div class="phase-header phase-3">
          <span class="phase-num">3</span> Synthesis &amp; HTML
        </div>
        <div class="phase-body">
          <div class="status-badge complete"><div class="status-dot"></div> Complete</div>

          <div class="agent-card" data-agent="3"
               data-tooltip="Agent 3: Generates governance synthesis report + 5 interactive HTML dashboards">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 3</div>
                <div class="agent-name">Report &amp; Dashboard Generator</div>
                <div class="agent-runtime">Automated generation</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value">Query results (Q1-Q4), Neo4j graph statistics, political era metadata</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">Generates narrative synthesis document with "So What" analysis chain. Creates self-contained HTML dashboards with Chart.js/D3.js visualizations. Applies HelpSeeker 2026 brand styling.</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value"><code>governance-synthesis.md</code> + 5 HTML dashboards (process overview, Sankey, network, heatmap, executive)</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">Claude Code automated pipeline</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Arrow 3→4 -->
      <div class="phase-connector" data-connector="3-4">
        <div class="arrow-line">
          <div class="arrow-dot" style="animation-delay: 1.2s;"></div>
        </div>
      </div>

      <!-- PHASE 4: Validation -->
      <div class="phase-column" data-phase="4">
        <div class="phase-header phase-4">
          <span class="phase-num">4</span> Validation
        </div>
        <div class="phase-body">
          <div class="status-badge complete"><div class="status-dot"></div> Complete</div>

          <div class="agent-card" data-agent="4"
               data-tooltip="Agent 4: Fact-checks claims, generates counter-arguments, and traces evidence provenance">
            <div class="agent-card-header">
              <div>
                <div class="agent-id">Agent 4</div>
                <div class="agent-name">Validator &mdash; Fact-Check &amp; Evidence</div>
                <div class="agent-runtime">Automated generation</div>
              </div>
              <span class="expand-icon">&#9660;</span>
            </div>
            <div class="agent-detail">
              <div class="detail-section">
                <div class="detail-section-label">Inputs</div>
                <div class="detail-section-value"><code>governance-synthesis.md</code>, query results, Neo4j graph</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Logic Summary</div>
                <div class="detail-section-value">Validates every claim against source data. Generates counter-arguments for key findings. Creates evidence traceability matrix linking claims to specific Cypher queries and data rows.</div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Outputs</div>
                <div class="detail-section-value"><code>fact-check-report.md</code>, <code>counter-arguments.md</code>, <code>evidence-traceability.csv</code></div>
              </div>
              <div class="detail-section">
                <div class="detail-section-label">Runtime</div>
                <div class="detail-section-value">Claude Code automated pipeline</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Data Provenance Footer -->
  <div class="provenance-footer">
    <h4>Data Provenance</h4>
    <div class="provenance-grid">
      <div class="provenance-item">
        <div class="pv-label">Source</div>
        <div class="pv-value">Neo4j graph analysis of GOA grants + CRA charity governance data</div>
      </div>
      <div class="provenance-item">
        <div class="pv-label">Query Date</div>
        <div class="pv-value">2026-02-12</div>
      </div>
      <div class="provenance-item">
        <div class="pv-label">Confidence</div>
        <div class="pv-value">MEDIUM-HIGH</div>
      </div>
      <div class="provenance-item">
        <div class="pv-label">Agent</div>
        <div class="pv-value">Claude Code automated pipeline</div>
      </div>
      <div class="provenance-item">
        <div class="pv-label">Graph Stats</div>
        <div class="pv-value">76,935 relationships across 12 node types</div>
      </div>
      <div class="provenance-item">
        <div class="pv-label">Source Records</div>
        <div class="pv-value">GOA 1.8M + GoC 2.2GB + CRA 570K directors</div>
      </div>
    </div>
  </div>

  <div class="page-footer">
    <strong>Operation Lineage Audit</strong> &mdash; HelpSeeker Technologies &copy; 2026<br>
    Generated from Neo4j graph analysis of Alberta Government grants &amp; CRA charity governance data.<br>
    This dashboard is a self-contained HTML artifact. No external data connections required.
  </div>
</div>

<!-- Tooltip element -->
<div class="tooltip-custom" id="globalTooltip"></div>

<script>
(function() {
  'use strict';

  // ===== EXPAND/COLLAPSE AGENT CARDS =====
  var agentCards = document.querySelectorAll('.agent-card');
  agentCards.forEach(function(card) {
    card.addEventListener('click', function(e) {
      this.classList.toggle('expanded');
    });
  });

  // ===== PHASE FILTER =====
  var phaseFilter = document.getElementById('phaseFilter');
  phaseFilter.addEventListener('change', function() {
    var val = this.value;
    var columns = document.querySelectorAll('.phase-column');
    var connectors = document.querySelectorAll('.phase-connector');

    if (val === 'all') {
      columns.forEach(function(col) { col.style.display = ''; });
      connectors.forEach(function(con) { con.style.display = ''; });
    } else {
      columns.forEach(function(col) {
        col.style.display = col.getAttribute('data-phase') === val ? '' : 'none';
      });
      connectors.forEach(function(con) {
        // Show connector only if both phases are visible
        var phases = con.getAttribute('data-connector').split('-');
        con.style.display = (phases[0] === val || phases[1] === val) ? '' : 'none';
      });
    }
  });

  // ===== EXPAND ALL TOGGLE =====
  var expandAll = document.getElementById('expandAll');
  expandAll.addEventListener('change', function() {
    var cards = document.querySelectorAll('.agent-card');
    var expand = this.checked;
    cards.forEach(function(card) {
      if (expand) {
        card.classList.add('expanded');
      } else {
        card.classList.remove('expanded');
      }
    });
  });

  // ===== ANIMATION TOGGLE =====
  var toggleAnim = document.getElementById('toggleAnimation');
  toggleAnim.addEventListener('change', function() {
    var dots = document.querySelectorAll('.arrow-dot');
    dots.forEach(function(dot) {
      dot.style.animationPlayState = toggleAnim.checked ? 'running' : 'paused';
      if (!toggleAnim.checked) {
        dot.style.opacity = '0';
      } else {
        dot.style.opacity = '';
      }
    });
  });

  // ===== HOVER TOOLTIPS =====
  var tooltip = document.getElementById('globalTooltip');

  agentCards.forEach(function(card) {
    card.addEventListener('mouseenter', function(e) {
      var text = this.getAttribute('data-tooltip');
      if (text) {
        tooltip.textContent = text;
        tooltip.classList.add('visible');
      }
    });
    card.addEventListener('mousemove', function(e) {
      tooltip.style.left = (e.clientX + 14) + 'px';
      tooltip.style.top = (e.clientY - 10) + 'px';
      // Keep tooltip within viewport
      var rect = tooltip.getBoundingClientRect();
      if (rect.right > window.innerWidth - 10) {
        tooltip.style.left = (e.clientX - rect.width - 14) + 'px';
      }
      if (rect.bottom > window.innerHeight - 10) {
        tooltip.style.top = (e.clientY - rect.height - 10) + 'px';
      }
    });
    card.addEventListener('mouseleave', function() {
      tooltip.classList.remove('visible');
    });
  });

})();
</script>

</body>
</html>